jQuery&&!function(e){"use strict";function t(e){var t=e.style.overflow;t&&"visible"!==t||(e.style.overflow="hidden");var s=e.clientWidth<e.scrollWidth;return e.style.overflow=t,s}function s(e){var t=e.find(".selectable.hover").position().top+e.find(".selectable.hover").outerHeight();t>e.innerHeight()&&e.scrollTop(e.scrollTop()+t-e.innerHeight()),e.find(".selectable.hover").position().top<0&&e.scrollTop(e.scrollTop()+e.find(".selectable.hover").position().top)}function i(t){var s=this.data("ultraselect").options;if(s.optGroupSelectable){var i=!0;e(t).children(":not(.optGroupLabel)").find("input:checkbox").each(function(){e(this).is(":checked")||(i=!1)}),e(t).find("input.optGroup").prop("checked",i).parent().toggleClass("checked",i)}}function l(){var s=this.children(".select"),i=this.children(".options"),l=s.find("span.selection"),a=this.data("ultraselect").options,n=0,c=!0,o="";i.find("input:checkbox").not(".selectAll, .optGroup").each(function(){e(this).is(":checked")?(n+=1,o=o+e(this).parent().text().trim()+", "):c=!1}),o=o.replace(/\s*,\s*$/,""),0===n?s.find("span.selection").html(a.noneSelected):"*"===a.oneOrMoreSelected||a.autoListSelected?(l.html(o),s.attr("title",o),a.autoListSelected&&t(l[0])&&l.html(a.oneOrMoreSelected.replace("%",n))):l.html(a.oneOrMoreSelected.replace("%",n)),a.selectAll&&i.find("input.selectAll").prop("checked",c).parent().toggleClass("checked",c)}function a(t,s){d+=1;var i=t+"_"+d,l=e("<div />",{class:"option"}),a=e("<input />",{type:"checkbox",name:t+"[]",id:i,tabindex:-1}),n=e("<label />",{for:i}),c=e("<span><span></span></span>");return a.val(s.value),s.selected&&a.prop("checked","checked"),l.append(a,n.append(c,s.text)).addClass(s.classes||"").data(s.data)}function n(t,s,i){var l,c,o,r,h=e("<div />",{class:"options"});for(c=0;c<s.length;c+=1)s[c].optgroup?(o=e("<div />"),o.attr("class",s[c].classes||null).addClass("optGroup").data(s[c].data),r=e("<label />"),i.optGroupSelectable&&(d+=1,l=t+"_"+d,o.append(e("<input />",{type:"checkbox",class:"optGroup",id:l,tabindex:-1})),r.attr("for",l).append("<span><span></span></span>")),o.append(r.append(s[c].optgroup)).wrapInner('<div class="optGroupLabel"></div>').append(n(t,s[c].options,i)),h.append(o)):h.append(a(t,s[c]));return h.children()}function c(t){d+=1;var a="selectAll_"+d,c=e(this),o=c.children(".select"),r=c.children(".options"),h=this.data("ultraselect"),p=h.options,u=h.callback;r.html(""),p.selectAll&&r.append(e("<div />",{class:"selectAll"}).append(e("<input />",{type:"checkbox",class:"selectAll",id:a,tabindex:-1}),e("<label />",{for:a}).append("<span><span></span></span>",p.selectAllText))),r.append(n(this.attr("id"),t,p)),c.ultraselect("setListHeight",p.listHeight),p.selectAll&&r.find("input.selectAll").click(function(){r.find("input:checkbox").prop("checked",e(this).is(":checked")).parent().toggleClass("checked",e(this).is(":checked"))}),p.optGroupSelectable&&(r.addClass("optGroupHasCheckboxes"),r.find("input.optGroup").click(function(){e(this).parent().parent().find("input:not(.optGroup, .selectAll):checkbox").prop("checked",e(this).is(":checked")).parent().toggleClass("checked",e(this).is(":checked"))})),r.find("input:checkbox").click(function(){e(this).parent().toggleClass("checked",e(this).is(":checked")),l.call(c),o.focus(),e(this).parent().parent().hasClass("optGroup")&&i.call(c,e(this).parent().parent()),u&&u(e(this))}),r.each(function(){e(this).find("input:checked").parent().addClass("checked")}),l.call(c),p.optGroupSelectable&&r.find("div.optGroup").each(function(){i.call(c,e(this))}),r.find("input:checkbox").parent().addClass("selectable"),r.find(".selectable").hover(function(){e(this).parent().find().removeClass("hover"),e(this).addClass("hover")},function(){e(this).removeClass("hover")}),o.keydown(function(t){if(r=e(this).next(".options"),"hidden"!==c.parent().css("overflow")){if(9===t.keyCode)return e(this).addClass("focus").trigger("click"),!0;if(27!==t.keyCode&&37!==t.keyCode&&39!==t.keyCode||e(this).addClass("focus").trigger("click"),40===t.keyCode||38===t.keyCode){var i=r.find(".selectable"),a=i.index(i.filter(".hover")),n=-1;return a<0?r.find(".selectable:first").addClass("hover"):40===t.keyCode&&a<i.length-1?n=a+1:38===t.keyCode&&a>0&&(n=a-1),n>=0&&(e(i.get(a)).removeClass("hover"),e(i.get(n)).addClass("hover"),s(r)),!1}if(13===t.keyCode||32===t.keyCode){var o=r.find("div.hover input:checkbox");return o.prop("checked",!o.is(":checked")).parent().toggleClass("checked",o.is(":checked")),o.hasClass("selectAll")&&r.find("input:checkbox").prop("checked",o.is(":checked")).parent().addClass("checked").toggleClass("checked",o.is(":checked")),l.call(c),u&&u(e(this)),!1}if(t.keyCode>=33&&t.keyCode<=126){var d=r.find(".selectable:startsWith("+String.fromCharCode(t.keyCode)+")"),h=d.index(d.filter(".selectable.hover")),p=d.filter(function(e){return e>h});d=p.length>=1?p:d,d=d.filter(".selectable:first"),1===d.length&&(r.find(".selectable.hover").removeClass("hover"),d.addClass("hover"),s(r))}}else{if(38===t.keyCode||40===t.keyCode||13===t.keyCode||32===t.keyCode)return e(this).removeClass("focus").trigger("click"),r.find(".selectable:first").addClass("hover"),!1;if(9===t.keyCode)return!0}if(13===t.keyCode)return!1})}function o(t,s,i){this.element=t,this.options=e.extend(!0,{},r,s),this.callback=i,this.init()}String.prototype.trim||!function(){var e=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;String.prototype.trim=function(){return this.replace(e,"")}}();var r={selectAll:!0,selectAllText:"Select All",noneSelected:"Select options",oneOrMoreSelected:"% selected",autoListSelected:!1,optGroupSelectable:!1,listHeight:200,maxWidth:!1},d=0;e.extend(o.prototype,{version:"2.0.0-dev",defaults:r,init:function(){var t=this.options,s=e(this.element);t.maxWidth="none"!==s.css("maxWidth")?s.css("maxWidth"):t.maxWidth;var i=e("<div />",{class:"ultraselect"}),l=e("<div />",{class:"select",tabIndex:0}),a=e("<div />",{class:"options",tabIndex:-1});l.append(e("<span />",{class:"selection"}),e("<span />",{class:"arrow"}).append(e("<b />"))),i.append(l,a),s.after(i),t.maxWidth&&l.css("maxWidth",t.maxWidth),i.addClass(s.attr("class")),i.data(s.data()),this.element=i[0],i.data("ultraselect",this);var n=[];s.children().each(function(){if("optgroup"===this.tagName.toLowerCase()){var t=[];n.push({optgroup:e(this).attr("label"),options:t,classes:e(this).attr("class"),data:e(this).data()||{}}),e(this).children("option").each(function(){""!==e(this).val()&&t.push({text:e(this).html(),value:e(this).val(),selected:e(this).prop("selected"),classes:e(this).attr("class"),data:e(this).data()||{}})})}else"option"===this.tagName.toLowerCase()&&""!==e(this).val()&&n.push({text:e(this).html(),value:e(this).val(),selected:e(this).prop("selected"),classes:e(this).attr("class"),data:e(this).data()||{}})}),s.remove(),i.attr("id",s.attr("id")),c.call(i,n),i.wrap('<div class="ultraselectWrapper"></div>'),i.parent().height(l.outerHeight()),l.hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")}).click(function(){return e(this).hasClass("active")?i.ultraselect("hideOptions"):i.ultraselect("showOptions"),!1}).focus(function(){e(this).addClass("focus")}).blur(function(){e(this).removeClass("focus")}),e(document).click(function(t){e(t.target).parents().addBack().is(".ultraselect > .options")||i.ultraselect("hideOptions")})},getValue:function(){var t=[];return e("input:not(.selectAll, .optGroup)",this.element).each(function(){e(this).is(":checked")&&t.push(e(this).val())}),t},setValue:function(t){var s=t?t:[];return"string"==typeof s&&(s=[t]),e("input:not(.selectAll, .optGroup)",this.element).each(function(){var t=s.indexOf(e(this).val())!==-1;e(this).prop("checked",t).parent().toggleClass("checked",t)}),l.call(e(this.element)),this},updateOptions:function(e){c.call(this,e)},hideOptions:function(){this.children(".select").removeClass("active").removeClass("hover"),this.parent().css("overflow","hidden")},showOptions:function(){var t=this.children(".select"),s=this.children(".options");e(".ultraselect").ultraselect("hideOptions"),this.parent().css("overflow","visible"),s.find(".option, .optGroup").removeClass("hover"),t.addClass("active").focus(),s.scrollTop(0)},selectedString:function(){var t="";return this.find("input:checkbox:checked").not(".optGroup, .selectAll").each(function(){t+=e(this).attr("value")+","}),t.replace(/\s*,\s*$/,"")},setListHeight:function(e){var t=this.children(".options");t.height()>e?(t.css("height",e+"px"),navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&t.addClass("_firefox")):t.css("height","")}}),e.expr[":"].startsWith=function(t,s,i){var l=i[3];return!!l&&new RegExp("^[/s]*"+l,"i").test(e(t).text())};var h=e.fn.val;e.fn.val=function(t){var s;return 0===arguments.length?(s=this.data("ultraselect"),s?s.getValue():h.call(this)):this.each(function(){s=e(this).data("ultraselect"),s?s.setValue(t):h.call(e(this),t)})},e.fn.ultraselect=function(t,s){var i=Array.prototype.slice.call(arguments,1);return this.each(function(){e(this).data("ultraselect")?"string"==typeof t&&"function"==typeof o.prototype[t]?e(this).data("ultraselect")[t].apply(e(this),i):console.log("ultraselect: invalid arguments"):new o(this,t,s)})}}(jQuery);